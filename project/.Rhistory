demand.f.wd.group <- summarise(demand.f.wd,demand = mean(demand.f.wd$demand))
View(demand.f.wd)
demand.f.wd.group <- summarise(demand.f.wd)
demand.f.wd.group <- summarise(demand.f.wd,demand = sum(demand))
demand.f.wd.group <- summarise(demand.f.wd,demand = ceiling(sum(demand)/20))
filter(demand.f.wd,Supermarket="Four Square BKs Torbay")
filter(demand.f.wd,Supermarket=="Four Square BKs Torbay")
filter(demand.f.wd,Supermarket=="Four Square Botany Junction")
View(demand.f.wd.group)
demand.f.wds= group_by(demand.four.weekday,Supermarket,weekday)
demand.f.wds.group <- summarise(demand.f.wd,demand = ceiling(sum(demand)/20))
View(demand.f.wds.group)
demand.f.wds.group <- summarise(demand.f.wd,weekday=weekday, demand = ceiling(sum(demand)/20))
demand.f.wd.group <- summarise(demand.f.wd,demand = ceiling(sum(demand)/20))
ggplot(demand.f.wd.group,aes(x=demand))+geom_histogram(stat="count")+facet_grid(~Supermarket)+theme_bw()
View(demand.f.wds)
demand.f.wd$demand-demand.f.wd$demand
demand.f.wd$demand-demand.f.wd.group$demand
demand.f.wd$error <- (demand.f.wd$demand-demand.f.wd.group$demand)*100
View(demand.f.wd)
demand.f.sum <- summarise(demand.f.wd,demand=sum(demand))
demand.f.sum$error <- (demand.f.wd$demand-7*demand.f.wd.group$demand)*100
demand.f.wd$demand-demand.f.wd.group$demand
View(demand.f.sum)
demand.f.sum$error <- (demand.f.wd$sum-7*demand.f.wd.group$demand)*100
demand.f.sum$error <- (demand.f.sum$demand-7*demand.f.wd.group$demand)*100
demand.f.sum$error <- (demand.f.wd.group$demand*4*5/demand.f.sum$demand)
View(demand)
filter(demand$demand>10)
demand
filter(demand$demand>10)
filter(demand$demand==10)
demand$demand
filter(demand,demand>10)
ggplot(demand.pak.weekday,aes(x=demand))+geom_histogram(stat="count")+facet_grid(Supermarket~day)+theme_bw()
View(demand.f.sum)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$test = as.Date(demand$date,format="%d/%m/%Y")
demand$day <- as.factor(weekdays(demand$test))
demand$weekday <- demand$day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday==TRUE)
d.four.end = filter(d.four,weekday==FALSE)
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(sum(demand)/20))
demand.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday==TRUE)
d.fresh.end = filter(d.fresh,weekday==FALSE)
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday==TRUE)
d.four.end = filter(d.four,weekday==FALSE)
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(sum(demand)/20))
d.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday==TRUE)
d.fresh.end = filter(d.fresh,weekday==FALSE)
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day.d <- summarise(d.fresh.day.g,demand = ceiling(sum(demand)/20))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(sum(demand)/20))
d.new = filter(demand,Type=="New")
d.new.day = filter(d.new,weekday==TRUE)
d.new.end = filter(d.new,weekday==FALSE)
d.new.day.g <- group_by(d.new.day,Supermarket)
d.new.day.d <- summarise(d.new.day.g,demand = ceiling(sum(demand)/20))
d.new.end.g <- group_by(d.new.end,Supermarket)
d.new.end.d <- summarise(d.new.end.g,demand = ceiling(sum(demand)/20))
d.pak = filter(demand,Type=="Pak")
d.pak.day = filter(d.pak,weekday==TRUE)
d.pak.end = filter(d.pak,weekday==FALSE)
d.pak.day.g <- group_by(d.pak.day,Supermarket)
d.pak.day.d <- summarise(d.pak.day.g,demand = ceiling(sum(demand)/20))
d.pak.end.g <- group_by(d.pak.end,Supermarket)
d.pak.end.d <- summarise(d.pak.end.g,demand = ceiling(sum(demand)/20))
d.plan.day <- rbind(d.four.day.d,d.fresh.day.d,d.new.day.d,d.pak.day.d)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
View(d.plan.day)
View(demand.four.weekend)
View(d.plan.end)
View(demand.f.sum)
View(demand.pak.weekend)
View(d.pak.end)
View(d.new.end.d)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday==TRUE)
d.four.end = filter(d.four,day=="Saturday")
library(tidyverse)
library(ggplot2)
demand = read_csv("C:/Users/jloo1/Dropbox/2nd Year/2nd Sem/263/OR/Project/demandData.csv", col_names=TRUE)
locations = read_csv("C:/Users/jloo1/Dropbox/2nd Year/2nd Sem/263/OR/Project/FoodstuffLocations.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$test = as.Date(demand$date,format="%d/%m/%Y")
demand$day <- as.factor(weekdays(demand$test))
demand$day = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand = read_csv("C:/Users/jloo1/Dropbox/2nd Year/2nd Sem/263/OR/Project/demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$day = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
View(demand)
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand = read_csv("C:/Users/jloo1/Dropbox/2nd Year/2nd Sem/263/OR/Project/demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday==TRUE)
d.four.end = filter(d.four,day=="Saturday")
d.four.end = filter(d.four,weekday=="Saturday")
View(d.four.end)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(sum(demand)/4))
View(d.four.day.d)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday==TRUE)
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
View(demand)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
View(d.four.day)
d.four.end = filter(d.four,day=="Saturday")
d.four.day = filter(d.four,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.four.end = filter(d.four,weekday=="Saturday")
View(d.four)
filer(d.four,weekday="Sunday")
filter(d.four,weekday="Sunday")
filter(d.four,weekday=="Sunday")
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(sum(demand)/11))
View(d.four.day.d)
View(d.four.end.d)
d.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday==TRUE)
d.fresh.end = filter(d.fresh,weekday=="Saturday")
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day.d <- summarise(d.fresh.day.g,demand = ceiling(sum(demand)/20))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(sum(demand)/20))
d.four.day = filter(d.four,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.four.end = filter(d.four,weekday=="Saturday")
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(sum(demand)/20))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(sum(demand)/11))
d.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.fresh.end = filter(d.fresh,weekday=="Saturday")
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day.d <- summarise(d.fresh.day.g,demand = ceiling(sum(demand)/20))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(sum(demand)/20))
View(d.fresh.end)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(mean(demand)))
View(d.four.end.d)
View(d.four.day.d)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(mean(demand)))
View(d.four.day.d)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(mean(demand)),d2 = ceiling(sum(demand)/20))
View(d.four.day.d)
d.four.day.d <- summarise(d.four.day.g,d1 = ceiling(mean(demand)),d2 = ceiling(sum(demand)/20))
d.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.fresh.end = filter(d.fresh,weekday=="Saturday")
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day.d <- summarise(d.fresh.day.g,d1 = ceiling(sum(demand)/20),d2 = ceiling(mean(demand)))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(sum(demand)/20))
View(d.fresh.day.d)
View(d.fresh.end.d)
d.new = filter(demand,Type=="New")
d.new.day = filter(d.new,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.new.end = filter(d.new,weekday=="Saturday")
d.new.day.g <- group_by(d.new.day,Supermarket)
d.new.day.d <- summarise(d.new.day.g,demand = ceiling(sum(demand)/20))
d.new.day.d <- summarise(d.new.day.g,d1 = ceiling(sum(demand)/20),d2=ceiling(mean(demand)))
View(d.new.day.d)
d.new.end.d <- summarise(d.new.end.g,d1 = ceiling(sum(demand)/20),d2 = ceiling(mean(demand)))
d.new.end.g <- group_by(d.new.end,Supermarket)
d.new.end.d <- summarise(d.new.end.g,d1 = ceiling(sum(demand)/20),d2 = ceiling(mean(demand)))
View(d.new.end.d)
View(d.new.end.g)
View(d.new.end.g)
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.four.end = filter(d.four,weekday=="Saturday")
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(mean(demand)))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(mean(demand)))
View(d.four.end.d)
d.fresh = filter(demand,Type=="Fresh")
d.fresh.day = filter(d.fresh,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.fresh.end = filter(d.fresh,weekday=="Saturday")
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day.d <- summarise(d.fresh.day.g,demand = ceiling(mean(demand)))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(mean(demand)))
View(d.fresh.end.d)
View(d.fresh.day.d)
d.new = filter(demand,Type=="New")
d.new.day = filter(d.new,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.new.end = filter(d.new,weekday=="Saturday")
d.new.day.g <- group_by(d.new.day,Supermarket)
d.new.day.d <- summarise(d.new.day.g,d1 = demand = ceiling(mean(demand)))
d.new.end.g <- group_by(d.new.end,Supermarket)
d.new.end.d <- summarise(d.new.end.g,demand = ceiling(mean(demand)))
View(d.new.day.d)
d.new.day.d <- summarise(d.new.day.g,demand = ceiling(mean(demand)))
d.new.day.g <- group_by(d.new.day,Supermarket)
d.new.end.g <- group_by(d.new.end,Supermarket)
d.new.end.d <- summarise(d.new.end.g,demand = ceiling(mean(demand)))
d.new.day.d <- summarise(d.new.day.g,demand = ceiling(mean(demand)))
View(d.new.day.d)
View(d.new.end.d)
d.pak = filter(demand,Type=="Pak")
d.pak.day = filter(d.pak,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.pak.day.g <- group_by(d.pak.day,Supermarket)
d.pak.end = filter(d.pak,weekday=="Saturday")
d.pak.day.d <- summarise(d.pak.day.g,demand = ceiling(mean(demand)))
d.pak.end.g <- group_by(d.pak.end,Supermarket)
d.pak.end.d <- summarise(d.pak.end.g,demand = ceiling(mean(demand)))
View(d.pak.end.d)
View(d.pak.end)
View(d.pak.day.d)
View(d.pak.day)
View(d.pak.day.d)
d.plan.day <- rbind(d.four.day.d,d.fresh.day.d,d.new.day.d,d.pak.day.d)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
d.error$day <- rbind(d.four.day.d$demand*20/sum(d.four.day$demand),d.fresh.day.d$demand*4/sum(d.fresh.day$demand),d.new.day.d$demand*4/sum(d.new.day$demand),d.pak.day.d$demand*4/sum(d.pak.day$demand))
d.four.day.d$demand*20/sum(d.four.day$demand)
write.csv(d.plan.day,'weekdaydemand.csv')
write.csv(d.plan.end,'weekenddemand.csv')
View(d.plan.day)
write.csv(d.plan.day,'weekdaydemand.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenddemand.csv',row.names = FALSE)
d.four.day.s <- summarise(d.four.day.g,sum = sum(demand))
View(d.four.day.s)
d.four.day.s <- summarise(d.four.day.g,sum = sum(demand))
d.four.end.s <- summarise(d.four.day.g,sum = sum(demand))
d.fresh.day.s <- summarise(d.fresh.day.g,sum = sum(demand))
d.fresh.end.s <- summarise(d.fresh.day.g,sum = sum(demand))
d.new.day.s <- summarise(d.new.day.g,sum = sum(demand))
d.new.end.s <- summarise(d.new.day.g,sum = sum(demand))
d.pak.day.s <- summarise(d.pak.day.g,sum = sum(demand))
d.pak.end.s <- summarise(d.pak.day.g,sum = sum(demand))
d.error$day <- rbind(d.four.day.d$demand*20/d.four.day.s$sum,d.fresh.day.d$demand*4/d.fresh.day.s$sum,d.new.day.d$demand*20/d.new.day.s$sum,d.pak.day.d$demand*20/d.pak.day.s$sum)
d.four.day.d$demand*20/d.four.day.s$sum
d.error$day <- d.four.day.d$demand*20/d.four.day.s$sum,d.fresh.day
d.error$day <- d.four.day.d$demand*20/d.four.day.s$sum
d.error = i for i in nrow(demand)
d.error = []
d.error
d.error <- data.frame(day=as.double(),end=as.double())
d.error$day <- rbind(d.four.day.d$demand*20/d.four.day.s$sum,d.fresh.day.d$demand*4/d.fresh.day.s$sum,d.new.day.d$demand*20/d.new.day.s$sum,d.pak.day.d$demand*20/d.pak.day.s$sum)
d.error$day <- d.four.day.d$demand*20/d.four.day.s$sum
d.error$day <- c(d.four.day.d$demand*20/d.four.day.s$sum)
d.error.day <- rbind(d.four.day.d$demand*20/d.four.day.s$sum,d.fresh.day.d$demand*4/d.fresh.day.s$sum,d.new.day.d$demand*20/d.new.day.s$sum,d.pak.day.d$demand*20/d.pak.day.s$sum)
View(d.error.day)
d.error <- rbind(d.four.day.s$Supermarket,d.fresh.day.s$Supermarket,d.new.day.s$Supermarket,d.pak.day.s$Supermarket)
View(d.error)
d.error <- rbind(c(d.four.day.s$Supermarket),c(d.fresh.day.s$Supermarket),c(d.new.day.s$Supermarket),c(d.pak.day.s$Supermarket))
View(d.error)
View(d.four.day)
View(d.plan.day)
View(d.four.day.d)
d.error <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
View(d.error)
d.error.day <- rbind(d.four.day.d$demand*20/d.four.day.s$sum,d.fresh.day.d$demand*4/d.fresh.day.s$sum,d.new.day.d$demand*20/d.new.day.s$sum,d.pak.day.d$demand*20/d.pak.day.s$sum)
d.error$demand <- d.plan.day$demand
d.four.end.s$scale <- nrow(d.four.day)/nrow(d.four.day.d)
View(d.four.end.s)
d.error <- rbind(c(d.four.day.s$Supermarket),c(d.fresh.day.s$Supermarket),c(d.new.day.s$Supermarket),c(d.pak.day.s$Supermarket))
d.four.end.s$scale <- nrow(d.four.day)/nrow(d.four.day.d)
d.four.day.s$scale <- nrow(d.four.day)/nrow(d.four.day.d)
d.new.day.s$scale <- nrow(d.new.day)/nrow(d.new.day.d)
d.pak.day.s$scale <- nrow(d.pak.day)/nrow(d.pak.day.d)
d.error <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
d.pak.day.s$scale <- nrow(d.pak.day)/nrow(d.pak.day.d)
d.new.day.s$scale <- nrow(d.new.day)/nrow(d.new.day.d)
d.four.day.s$scale <- nrow(d.four.day)/nrow(d.four.day.d)
d.four.day.s$scale <- nrow(d.four.day)/nrow(d.four.day.d)
d.fresh.day.s$scale <- nrow(d.fresh.day)/nrow(d.fresh.day.d)
d.error <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
View(d.error)
View(d.fresh.day)
d.fresh.day.d$demand*20/d.fresh.s$sum
d.fresh.day.d$demand*20/d.fresh.day.s$sum
d.four.day.s$scale <- 20
d.fresh.day.s$scale <- 20
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
d.plan.day <- rbind(d.four.day.d,d.fresh.day.d,d.new.day.d,d.pak.day.d)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
d.error <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
d.error$demand <- d.plan.day$demand
d.error$scale <- 20
d.error$error <- d.error$demand*20/d.error$sum
View(d.four.day.s)
View(d.four.end.s)
View(d.four.day.s)
View(d.four.end.s)
View(d.four.end.d)
View(d.four.end.g)
d.four.end.s <- summarise(d.four.end.g,sum = sum(demand))
d.new.end.s <- summarise(d.new.end.g,sum = sum(demand))
d.fresh.end.s <- summarise(d.fresh.end.g,sum = sum(demand))
d.four.end.s <- summarise(d.four.end.g,sum = sum(demand))
d.pak.end.s <- summarise(d.pak.end.g,sum = sum(demand))
View(d.fresh.end.g)
View(d.fresh.end.s)
d.error.end <- rbind(d.four.end.s,d.fresh.end.s,d.new.end.s,d.pak.end.s)
d.error.end$scale <- 4
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
d.error.end <- rbind(d.four.end.s,d.fresh.end.s,d.new.end.s,d.pak.end.s)
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
View(d.error.end)
View(d.pak.day.g)
View(d.pak.end.d)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
d.error.end$demand <- d.plan.end$demand
View(d.pak.end.d)
d.pak.end.d <- summarise(d.pak.end.g,demand = ceiling(mean(demand)))
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.day.d,d.pak.day.d)
View(d.plan.end)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.end.d,d.pak.end.d)
d.error.day <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end <- rbind(d.four.end.s,d.fresh.end.s,d.new.end.s,d.pak.end.s)
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
write.csv(d.plan.day,'weekdaydemand.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenddemand.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenderror.csv',row.names = FALSE)
write.csv(d.plan.day,'weeklyerror.csv',row.names = FALSE)
rstudioapi::getActiveDocumentContext.
rstudioapi::getActiveDocumentContext
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
demand = read_csv("demandData.csv", col_names=TRUE)
demand = read_csv("demandData.csv", col_names=TRUE)
weekday = filter(demand,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
weekday <- filter(demand,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
#Reading in data and cleaning
demand = read_csv("demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
weekday <- filter(demand,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
View(demand)
View(weekday)
weekday.g <- group_by(weekday.g,Supermarket)
weekday.g <- group_by(weekday,Supermarket)
weekday.d <- summarise(weekday,demand = ceiling(mean(demand)))
View(weekday.d)
weekday.g <- group_by(weekday,Supermarket)
weekday.d <- summarise(weekday.g,demand = ceiling(mean(demand)))
View(weekday.d)
weekend <- filter(demand,weekend == "Saturday")
weekend.g <- group_by(weekend,Supermarket)
weekend.d <- summarise(weekend.g,demand = ceiling(mean(demand)))
weekend.g <- group_by(weekend,Supermarket)
weekend.d <- summarise(weekend.g,demand = ceiling(mean(demand)))
weekend <- filter(demand,weekend == "Saturday")
weekend <- filter(demand,weekday == "Saturday")
weekend.g <- group_by(weekend,Supermarket)
weekend.d <- summarise(weekend.g,demand = ceiling(mean(demand)))
View(weekend.d)
#Loading required libraries
library(tidyverse)
library(ggplot2)
#Reading in data and cleaning
demand = read_csv("demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
#Calculating demand for Four Square
d.four = filter(demand,Type=="Four")
d.four.day = filter(d.four,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.four.end = filter(d.four,weekday=="Saturday")
d.four.day.g <- group_by(d.four.day,Supermarket)
d.four.day.d <- summarise(d.four.day.g,demand = ceiling(mean(demand)))
d.four.end.g <- group_by(d.four.end,Supermarket)
d.four.end.d <- summarise(d.four.end.g,demand = ceiling(mean(demand)))
d.four.end.s <- summarise(d.four.end.g,sum = sum(demand))
d.fresh = filter(demand,Type=="Fresh")
d.four.day.s <- summarise(d.four.day.g,sum = sum(demand))
d.fresh.end = filter(d.fresh,weekday=="Saturday")
d.fresh.day.g <- group_by(d.fresh.day,Supermarket)
d.fresh.day = filter(d.fresh,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.fresh.end.g <- group_by(d.fresh.end,Supermarket)
d.fresh.day.s <- summarise(d.fresh.day.g,sum = sum(demand))
d.fresh.end.s <- summarise(d.fresh.end.g,sum = sum(demand))
d.new = filter(demand,Type=="New")
d.fresh.end.d <- summarise(d.fresh.end.g,demand = ceiling(mean(demand)))
d.new.day = filter(d.new,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.fresh.day.d <- summarise(d.fresh.day.g,demand = ceiling(mean(demand)))
d.new.end = filter(d.new,weekday=="Saturday")
d.new.day.g <- group_by(d.new.day,Supermarket)
d.new.day.d <- summarise(d.new.day.g,demand = ceiling(mean(demand)))
d.new.end.g <- group_by(d.new.end,Supermarket)
d.new.end.d <- summarise(d.new.end.g,demand = ceiling(mean(demand)))
d.new.day.s <- summarise(d.new.day.g,sum = sum(demand))
d.new.end.s <- summarise(d.new.end.g,sum = sum(demand))
d.pak = filter(demand,Type=="Pak")
d.pak.day = filter(d.pak,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
d.pak.end = filter(d.pak,weekday=="Saturday")
d.pak.day.g <- group_by(d.pak.day,Supermarket)
d.pak.day.d <- summarise(d.pak.day.g,demand = ceiling(mean(demand)))
d.pak.end.g <- group_by(d.pak.end,Supermarket)
d.pak.end.d <- summarise(d.pak.end.g,demand = ceiling(mean(demand)))
d.pak.day.s <- summarise(d.pak.day.g,sum = sum(demand))
d.pak.end.s <- summarise(d.pak.end.g,sum = sum(demand))
d.plan.day <- rbind(d.four.day.d,d.fresh.day.d,d.new.day.d,d.pak.day.d)
d.plan.end <- rbind(d.four.end.d,d.fresh.end.d,d.new.end.d,d.pak.end.d)
d.error.day <- rbind(d.four.day.s,d.fresh.day.s,d.new.day.s,d.pak.day.s)
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end <- rbind(d.four.end.s,d.fresh.end.s,d.new.end.s,d.pak.end.s)
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
write.csv(d.plan.day,'weekdaydemand.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenddemand.csv',row.names = FALSE)
write.csv(d.plan.day,'weeklyerror.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenderror.csv',row.names = FALSE)
View(d.plan.end)
d.plan.day <- summarise(weekday.g,demand = ceiling(mean(demand)))
d.plan.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
weekday.s <- summarise(weekday.g,sum = sum(demand))
weekend.s <- summarise(weekend.g, sum = sum(demand))
d.error <- summarise(weekday.g,sum = sum(demand))
d.error.day <- summarise(weekday.g,sum = sum(demand))
d.weekend.day <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
d.plan.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
d.error.end <- summarise(weekend.g, sum = sum(demand))
d.plan.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
source('~/.active-rstudio-document', echo=TRUE)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#Loading required libraries
library(tidyverse)
library(ggplot2)
#Reading in data and cleaning
demand = read_csv("demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
weekday <- filter(demand,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
weekday.g <- group_by(weekday,Supermarket)
d.error.day <- summarise(weekday.g,sum = sum(demand))
d.plan.day <- summarise(weekday.g,demand = ceiling(mean(demand)))
weekend <- filter(demand,weekday == "Saturday")
weekend.g <- group_by(weekend,Supermarket)
d.error.end <- summarise(weekend.g, sum = sum(demand))
d.plan.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
View(d.plan.day)
View(d.plan.end)
View(d.error.day)
View(d.error.end)
#Setting current working directory to source file location
rstudioapi::getActiveDocumentContext
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#Loading required libraries
library(tidyverse)
library(ggplot2)
#Reading in data and cleaning
demand = read_csv("demandData.csv", col_names=TRUE)
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand = gather(demand,key=date,value=demand,ends_with("19"))
demand$weekday = as.factor(weekdays(as.Date(demand$date,format="%d/%m/%Y")))
demand$Type <- sub("(\\w+).*", "\\1", demand$Supermarket)
weekday <- filter(demand,weekday%in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
weekday.g <- group_by(weekday,Supermarket)
d.error.day <- summarise(weekday.g,sum = sum(demand))
d.plan.day <- summarise(weekday.g,demand = ceiling(mean(demand)))
weekend <- filter(demand,weekday == "Saturday")
weekend.g <- group_by(weekend,Supermarket)
d.error.end <- summarise(weekend.g, sum = sum(demand))
d.plan.end <- summarise(weekend.g,demand = ceiling(mean(demand)))
d.error.day$demand <- d.plan.day$demand
d.error.day$error <- d.error.day$demand*20/d.error.day$sum
d.error.end$demand <- d.plan.end$demand
d.error.end$error <- d.error.end$demand*4/d.error.end$sum
write.csv(d.plan.day,'weekdaydemand.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenddemand.csv',row.names = FALSE)
write.csv(d.plan.day,'weeklyerror.csv',row.names = FALSE)
write.csv(d.plan.end,'weekenderror.csv',row.names = FALSE)
